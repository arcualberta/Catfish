@model Catfish.Models.Regions.ListEntitiesPanel
@using Catfish.Core.Models;


 @{ string cssId = string.IsNullOrEmpty(Model.CssId) ? Guid.NewGuid().ToString().Replace('-', 'K') : Model.CssId;
     string cssClasses = string.IsNullOrEmpty(Model.CssClasses) ? "" : Model.CssClasses;
     string cssStyles = string.IsNullOrEmpty(Model.CssStyles) ? "" : Model.CssStyles;
 }
<div id="@cssId" class="bs @cssClasses container container-fluid">
    <style type="text/css" scoped>
           @Html.Raw(cssStyles)
    </style>
   <div class="row" style="text-align:center;margin-top:20px;">
       <button class="btn-link" name="listEntitiesPanel_prev_button" onclick="GoToPage('Prev'); return false;"><span style="align-content:center"><span class="glyphicon glyphicon-backward"></span>Prev</span></button>
       <input id="listEntitiesPanel_page_number" placeholder="1" value="@Model.CurrentPage" style="width:15px; height:15px;" />
       <button class="btn-link" name="listEntitiesPanel_next_button" onclick="GoToPage('Next'); return false;"><span style="align-content:center">Next<span class="glyphicon glyphicon-forward"></span></span></button>
    </div>
    <div class="row ">
        <table class="table table-responsive table-striped">
            <tr>
                @*header*@
                @foreach (var f in Model.Fields)
                {
                    string header = Model.Items[0].GetAttributeMappingLabel(f);
                    if (!string.IsNullOrEmpty(header))
                    {
                        <th>@header </th>
                    }
                }
            </tr>

            @*content*@
            @foreach (var item in Model.Items)
            {
                <tr>
                    @foreach (var f in Model.Fields)
                    {
                        string content = item.GetAttributeMappingValue(f);
                        <td>@content</td>
                    }
                </tr>
            }
        </table>
    </div>
    <div class="row" style="text-align:center;">
        <button class="btn-link" name="listEntitiesPanel_prev_button"  onclick="GoToPage('Prev'); return false;" ><span style="align-content:center"><span class="glyphicon glyphicon-backward"></span>Prev</span></button>
        <input id="listEntitiesPanel_page_number" placeholder="1" value="@Model.CurrentPage" style="width:15px; height:15px;" />
        <button class="btn-link" name="listEntitiesPanel_next_button" onclick="GoToPage('Next'); return false;"><span style="align-content:center">Next<span class="glyphicon glyphicon-forward"></span></span></button>
    </div>
</div>

<script>

   $(document).ready(function() {
       var curPage =@Model.CurrentPage;
       if(curPage == 1)
        {
           $("[name='listEntitiesPanel_prev_button']").hide();
        }

       if(@Model.ItemCount < @Model.ItemPerPage)
        {
             $("[name='listEntitiesPanel_next_button']").hide();
        }
   });

    function GoToPage(whichPage){
        var currPage =@Model.CurrentPage;
        if(whichPage === "Prev")
        {
             currPage = currPage - 1;
        }
        else if(whichPage === "Next"){
             currPage = currPage + 1;
        }

        var url_str = window.location.href;
        var base_url = url_str.substr(0,url_str.indexOf("?"));

         if (url_str.indexOf('?') > -1){
            var url_param = window.location.search;
            if( url_param.indexOf('page') >= 0){
                 if(url_param.indexOf('&') >= 0) //check if another parameters existed
                 {
                     var params = url_param.split('&');
                     for(var i=0; i < params.length; i++)
                     {
                          if(params[i].indexOf('page') >= 0)
                           {
                               params[i] = params[i].substr(0, params[i].indexOf('=')) + "=" + currPage;
                               break;
                           }
                      }
                      url_param = params.join('&');
                 }
                 else{
                      //only page parameter
                      url_param = url_param.substr(0, url_param.indexOf("=")) + "=" + currPage;
                }
                 base_url += url_param;
            }
         }
        window.location.href = base_url;
    }

   
</script>