@model Piranha.Extend.Blocks.ImageGalleryBlock
@using Piranha.Extend.Blocks

@inject Catfish.Helper.ICatfishAppConfiguration _catfishConfig;
@{
    var unique = "gallery-" + Guid.NewGuid().ToString();

    var displayThumbnails = _catfishConfig.DisplayCarouselThumbnails();
    int indicatorIndex = 0;
}
@if (!displayThumbnails)
{ //default image gallery from piranha
    <div id="@unique" class="carousel slide gallery-block" data-ride="carousel">
        <ol class="carousel-indicators">
            @for (var n = 0; n < Model.Items.Count; n++)
            {
                <li data-target="#@unique" data-slide-to="@n" class="@(n == 0 ? "active" : "")"></li>
            }
        </ol>
        <div class="carousel-inner">
            @foreach (var item in Model.Items)
            {
                <div class="carousel-item @(item == Model.Items.First() ? "active" : "")">
                    <img src="@Url.Content(WebApp.Media.ResizeImage(((ImageBlock)item).Body.Media, 890, 482))" class="d-block w-100">
                </div>
            }
        </div>
        <a class="carousel-control-prev" href="#@unique" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#@unique" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
}
else
{
    //our custom with thumbnail
    <div id="@unique" class="carousel slide gallery-block" data-ride="carousel">

        <div class="carousel-inner">
            @foreach (var item in Model.Items)
            {
                <div class="carousel-item @(item == Model.Items.First() ? "active" : "")">
                    <img src="@Url.Content(WebApp.Media.ResizeImage(((ImageBlock)item).Body.Media, 890, 482))" class="d-block w-100">
                </div>
            }
        </div>
        <a class="carousel-control-prev" href="#@unique" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#@unique" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>

        <ul class="carousel-indicators thumb-list-inline mx-auto border px-2">
            @foreach (var item in Model.Items)
            {
                
                <li class="list-inline-item @(item == Model.Items.First() ? "active" : "")">
                    <a id="carousel-selector-@indicatorIndex" class="@(item == Model.Items.First() ? "selected" : "")" data-slide-to="@indicatorIndex" data-target="#@unique">
                        <img src="@Url.Content(WebApp.Media.ResizeImage(((ImageBlock)item).Body.Media, 80, 60))" class="img-fluid">
                    </a>
                </li>
                indicatorIndex++;
            }
        </ul>
    </div>


}
<style>
    /*.img-fluid {
        max-width: 100%;
        height: auto;
    }
    .thumb-list-inline {
        white-space: nowrap;
        overflow-x: auto;
    }*/
   
    #@unique .carousel-indicators {
        position: static;
        left: initial;
        width: initial;
        margin-left: initial;
    }

    #@unique .carousel-indicators > li {
        width: initial;
        height: initial;
        text-indent: initial;
    }

    #@unique .carousel-indicators > li.active img {
        opacity: 0.7;
     }
</style>