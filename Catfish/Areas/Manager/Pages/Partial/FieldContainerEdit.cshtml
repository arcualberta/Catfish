@model Catfish.Areas.Manager.Pages.FieldContainerPageModel
@inject Piranha.Manager.ManagerLocalizer Localizer
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

<div id="edit-field-form-page">
    <div class="top">
        <div class="container-fluid top">
            <div class="left-nav-container">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item">@Localizer.Menu["Templates"]</li>
                        <li class="breadcrumb-item">@Localizer.Menu[Model.ModelLabel]</li>
                        <li class="breadcrumb-item">@Localizer.Menu["Edit"]</li>
                        <li class="breadcrumb-item active" aria-current="page">@Localizer.Menu[Model.Model.Id.ToString()]</li>
                    </ol>
                </nav>
            </div>

            <div class="container-fluid collection-button-holder">
                <div class="top-nav"> SOME BUTTON
                    @*@foreach (var action in Catfish.Areas.Manager.Actions.Toolbars.FormList)
                    {
                        <partial name="@action.ActionView" />
                    }*@
                </div>
            </div>
        </div>
    </div>

    @{ var url = Model.ApiRoot + Model.Model.Id.ToString();}
    <a href="@url" target="_blank">See JSON Object</a>

    <form v-if="finishedGET">
        <div class="form-group">
            <label for="form-title">Title</label>
            <div v-for="(name, titleIndex) of names.values">
            <input type="text" class="form-title form-control" :value="name.value" 
                :id="'form-title-' + titleIndex" placeholder="Title Your Form Here" />
            </div>

            <label for="form-description">Description</label>
            <div v-for="(description, descriptionIndex) of descriptions.values">
                <textarea type="text" class="form-description form-control" 
                :id="'form-description-' + descriptionIndex"
                placeholder="Description goes here">
                {{description.value}}
                </textarea>
            </div>

            <hr />

            <label for="">Fields</label>
            <draggable v-model="fields" group="sharedItems" handle=".handle-drag">
                <div v-for="(field, fieldIndex) of fields" class="card">

                    <div class="sitemap-item">
                        <a v-on:click="toggleDropdown(field.id)" class="handle-holder" data-toggle="collapse" :href="['#collapse-' + fieldIndex ]">
                            <div class="handle">
                                <i class="fas fa-chevron-up"></i> <!-- :class="{ 'fas fa-chevron-down': !dropdowns[collection.id].isCollapsed, 'fas fa-chevron-right': dropdowns[collection.id].isCollapsed}" -->
                            </div>
                        </a>
                        <div class="title-header"></div>
                    </div>

                    <div style="display:flex;">

                    <div class="handle-drag draggable">
                        <i class="fas fa-grip-vertical"></i>
                    </div>

                        <div class="field-card-contents">
                            <div class="card-header" style="text-transform:none;">
                                <h4>
                                Title
                                </h4>
                            
                                <!--<button type="button" class="btn btn-secondary rounded" data-toggle="popover"
                                    data-content="This is the title of the question you want to ask.">
                                    <i class="fas fa-info"></i>
                                </button>-->
                            </div>
                

                            <ul v-for="nameValue of field.name.values" class="list-group list-group-flush">
                                <li class="list-group-item flex-li">
                                    <label class="field-item-label">{{nameValue.language}}</label>
                                    <input type="text" class="field-input form-control" :value="nameValue.value" 
                                    :id="'field-title-' + fieldIndex + '-' + nameValue" 
                                    placeholder="Title Your Field Here" />
                                </li>
                            </ul>

                            <div class="card-header" style="text-transform:none;">
                                <h4>
                                Description
                                </h4>
                            
                                <!--<button type="button" class="btn btn-secondary rounded" data-toggle="popover"
                                    data-content="This should provide more detail about what you want to ask. Optional.">
                                    <i class="fas fa-info"></i>
                                </button>-->
                            </div>

                            <ul v-for="descriptionValue of field.description.values" class="list-group list-group-flush">
                                <li class="list-group-item flex-li">
                                    <label class="field-item-label">{{descriptionValue.language}}</label>
                                    <textarea type="text" class="field-input form-control" 
                                    :id="'field-description-' + fieldIndex + '-' + descriptionValue" 
                                    placeholder="Describe the purpose of this field...">
                                    {{descriptionValue.value}}
                                    </textarea>
                                </li>
                            </ul>

                            <input v-if="field.$type == 'Catfish.Core.Models.Contents.Fields.TextField, Catfish.Core' "
                                class="form-control" readonly placeholder="Short answer"/>
                            <textarea v-else-if="field.$type == 'Catfish.Core.Models.Contents.Fields.TextArea, Catfish.Core' "
                                class="form-control" placeholder="Long answer" readonly>
                            </textarea> 

                            <div class="form-check card-footer">
                                <input class="form-check-input" type="checkbox" :value="field.required" 
                                :id="'required-checkbox-' + fieldIndex">
                                <label class="form-check-label" :for="'required-checkbox-' + fieldIndex">
                                    Required
                                </label>
                            </div>
                        </div>
                    
                    </div>

                </div>
            </draggable>
            
        </div>
    </form>
    <div v-else>Put loading something or other here</div>

</div>