@model Catfish.Core.Models.Collection
@using Catfish.Areas.Manager.Models.ViewModels;
@using Catfish.Core.Models;

@{ ViewBag.Title = "Entity Associations"; }

@section HEAD
{
    <script type="text/javascript" src="~/Scripts/knockout-3.1.0.js"></script>
    <script type="text/javascript" src="~/Scripts/knockout.mapping-latest.js"></script>
    <script type="text/javascript" src="~/Scripts/perpetuum.knockout.js"></script>
    <link rel="stylesheet" type="text/css" href="~/Content/Css/catfish.css">
}

@section Toolbar {
    @Html.Partial("Partial/koEditToolbar", Model, new ViewDataDictionary() { { "reloadAction", "items" } })
}

<div class="grid_12">
    <h3>@Model.GetName()</h3>

    <div class="bs entity-content">
        <div class="box">
            <div class="title">
                Parent Collections
            </div>
            @{ IEnumerable<Aggregation> parents = Model.ParentMembers.Where(p => typeof(Collection).IsAssignableFrom(p.GetType())); }
            @Html.Partial("Partial/ObjectList", parents, new ViewDataDictionary() { { "title", "Parent Entities" } })
        </div>
    </div>

    @{ EntityContentViewModel childCollections = ViewBag.ChildCollections as EntityContentViewModel; }
    @Html.Partial("Partial/EntityContent", childCollections, new ViewDataDictionary() { { "title", "Child Collections" } })

    @{ EntityContentViewModel childItems = ViewBag.ChildItems as EntityContentViewModel; }
    @Html.Partial("Partial/EntityContent", childItems, new ViewDataDictionary() { { "title", "Items" } })
</div>
