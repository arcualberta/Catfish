@model Catfish.Models.Regions.AdvanceSearchContainer

<ul class="form">

    @Html.Partial("_CatfishRegion", Model)

   
    <li>
        @Html.LabelFor(m => m.Fields)
        <div class="bs input">
            <div>
                <table class="table table-responsive table-striped" id="AttributeMappingTable">
                    @{
                        int i = 0;
                        foreach (var f in Model.Mappings)
                        {
                           
                            string rowId = "AdvanceSearchRegion_row_" + i;
                            <tr id="@rowId">
                                <input type="hidden" name="@(Html.NameFor(m => m.Fields)).Index" value="@(i)" />
                                @Html.HiddenFor(m => m.Fields[i])
                                <td><span>@f.Name</span></td>
                                <td>@Html.CheckBoxFor(m=>m.Multiples[i])</td>
                                <td><span class="glyphicon glyphicon-minus-sign" onclick="DeleteAdvancedSearchRow('@rowId');"></span><span class="glyphicon glyphicon-arrow-up up"></span><span class="glyphicon glyphicon-arrow-down down"></span></td>
                            </tr>

                            ++i;
                        }
                        <tr id="AdvanceSearchRegion_ddFields">
                            <input type="hidden" class="hdregionAdvanceSearchContainer" value="@Html.IdFor(m => m)" />
                            <td>@Html.DropDownList("selectedField", Model.FieldsMapping, new { @class = "btn btn-default", @style = "padding: 2px 2px" })</td>
                            <td><span class="glyphicon glyphicon-plus-sign" onclick="AddAdvancedSearchField()"></span></td>
                        </tr>

                    }
                </table>
            </div>
        </div>
    </li>
</ul>

<script>
    $( document ).ready(function() {
       $('.up,.down').click(function () {
          var row = $(this).parents('tr:first');
          if ($(this).is('.up')) {
               row.insertBefore(row.prev())
          }
         else {
            row.insertAfter(row.next());
           }
     });


    });
    function AddAdvancedSearchField()
    {
        var uniqueId = Math.random().toString(36).substring(2) + (new Date()).getTime().toString(36);
        var regionName = $(".hdregionAdvanceSearchContainer").val(); // Region_0
         var regionInd = regionName.split("_")[1];//0,1,etc
      var FieldId = $("#" + regionName + "_selectedField").val();
     var FieldText = $("#" + regionName + "_selectedField option:selected").text();

     var rowCount = $('#AttributeMappingTable tr').length;
     var rowId = "AdvanceSearchRegion_row_" + (rowCount - 1);
     var chkIndex = Math.floor(Math.random() * 10) + 100;

      var t = `<tr id="` + rowId +`"><input type="hidden" name="Regions[`+regionInd +`].Body.Fields.Index" value="` + uniqueId + `">
    <input type="hidden" name="Regions[`+regionInd +`].Body.Multiples.Index" value="M` + uniqueId + `">
               <input name="Regions[`+regionInd +`].Body.Fields[` + uniqueId +  `]" type="hidden" value="` + FieldId +`">
                    <td><span>` + FieldText + `</span></td>

                      <td><input data-val="true" data-val-required="The Boolean field is required." id="Regions_` + regionInd + `__Body_Multiples_M` + uniqueId +`_"  name="Regions[`+regionInd +`].Body.Multiples[M`+uniqueId +`]" type="checkbox" value="true">
                           <input name="Regions[`+ regionInd + `].Body.Multiples[M`+ uniqueId +`]" type="hidden" value="false">
                      </td>
                    <td><span class="glyphicon glyphicon-minus-sign" onclick="DeleteAdvancedSearchRow('` + rowId +`')"></span><span class="glyphicon glyphicon-arrow-up"></span><span class="glyphicon glyphicon-arrow-down"></span></td>
                </tr>`;

      $("#AdvanceSearchRegion_ddFields").before(t)


    }

    function DeleteAdvancedSearchRow(index)
    {
       $("#" + index).remove();
    }
</script>
<input data-val="true" data-val-required="The Boolean field is required." id="Regions_0__Body_Multiples_0_" name="Regions[0].Body.Multiples[0]" type="checkbox" value="true">
<input name="Regions[0].Body.Multiples[0]" type="hidden" value="false">