@page "~/discussion/{id:Guid}"
@model Catfish.Pages.DiscussionModel

@using Catfish.Core.Authorization.Requirements;
@using Microsoft.AspNetCore.Authorization;

@inject Piranha.Manager.ManagerLocalizer Localizer
@inject Catfish.Services.ISubmissionService _submissionService;
@inject Catfish.Core.Services.IWorkflowService _workflowService;
@inject Microsoft.AspNetCore.Authorization.IAuthorizationService _authorizationService;
@inject Catfish.Services.IEntityTemplateService _entityTemplateService;
@inject Catfish.Helper.ICatfishAppConfiguration _appConfig;
@{
    ViewData["Title"] = "Discussion";
}
@{
    var item = _submissionService.GetSubmissionDetails(Model.Tile.Id);


    //var subtitle = Model.Subtitle;
    string successMessage = "";//string.IsNullOrEmpty(Model.SubmissionConfirmation.Value.ToString()) ? "" : Model.SubmissionConfirmation.Value.ToString();
}
@if ((await _authorizationService.AuthorizeAsync(User, item, new List<IAuthorizationRequirement>() { TemplateOperations.Read }))
.Succeeded)
{
    <div class="container item-details-view">
        <h1>@Model.Tile.Title</h1>
        <h6>@Model.Tile.Subtitle</h6>
        <div class="container">
            <div class="row">
                <div class="col-sm-2">
                    <img src="@Url.Content(Model.Tile.Thumbnail)" alt="Image" style="height:100px;width:100px;" />
                </div>
                <div class="col-sm-10">
                    <p>@Model.Tile.Content</p>
                </div>
            </div>
        </div>
    </div>
}
else
{
    <div class="alert alert-danger">@Html.Raw(_appConfig.GenericAuthorizationErrorMessage())</div>
}